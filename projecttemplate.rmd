---
output:
  html_document: default
  pdf_document: default
  word_document: default
---
Analysis of Elections in India
========================================================
By Mohd Hassaan
-------------

## Introduction

India is the largest democracy in the world, it has mainly two kind of election state and national election. National election is conducted on 545 seats and state election is conducted on more than 4000 seats in 5 years. more than 500 million people voted in the 2014 election. What could be more intresting than analysing the data of indian elections through out the years.

In this project we are going to analyse the data of India's National and state elections from 1978 to 2014.

> **Source**:  https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/26526


### Initial Exploration 
```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using in your analysis in this code
# chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk. This
# prevents the code from displaying in the knitted HTML output. You should set
# echo=FALSE for all code chunks in your file, unless it makes sense for your
# report to show the code that generated a particular plot.

# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.
library(dplyr)
library(ggplot2)
library(tidyr)
library(scales)
library(gridExtra)
library(extrafont)
library(sp)
library(RColorBrewer)

setwd("D:/Data Analyst/R/India Election Analysis with R")

```

### Structure of the data

```{r echo=FALSE, Load_the_Data}

# Load the Data
state_election = read.table('statelection.tab',sep="\t", header=TRUE)
national_election = read.table('nationalelection.tab',sep="\t", header=TRUE)

#no of observation in the data and the columns
dim(state_election)
dim(national_election)

#type of data column
str(state_election)
str(national_election)

```

We have two Kind of data set. First one is of state election and other is for national, both data set have the same structure. It has state name, constituency name, total electorates, votes polled, cadidate name etc.
The main visual difference between both data is that the few column name in national election data prefixes with pc(parliamentary constituency) and the same columns in state election data prefixes with ac(assembly constituency).

### Adding new variables

Before we go into any analysis we are going to add some new variables in the data. We are going to add a variable name proportion which gives us the proportion of vote a candidate get. the another variable is booleean variable which store the information about the candidate's winning or loosing.


```{r echo=FALSE, making_variables}

#Making a variable proportion to reflect the vote proportion of each candidate
state_election$proportion = state_election$totvotpoll / state_election$electors
national_election$proportion = national_election$totvotpoll / national_election$electors
head(state_election)
head(national_election)

#making a variable with the winning vote
national_election.winner_vote <- national_election %>%
  group_by(st_name, year,pc_no) %>%
  summarise(win_vote = max(totvotpoll))

state_election.winner_vote <- state_election %>%
  filter(!is.na(totvotpoll)) %>%
  group_by(st_name, year,ac_no) %>%
  summarise(win_vote = max(totvotpoll))

#making the left join to the orignal data
Nat_election <- 
  merge(national_election,national_election.winner_vote, by = c('st_name','year','pc_no'),x.all = TRUE )

St_election <- 
  merge(state_election,state_election.winner_vote, by = c('st_name','year','ac_no'),x.all = TRUE )

#making our won variable to reflect the winning status of the candidate
Nat_election$won = ifelse(Nat_election$totvotpoll == Nat_election$win_vote,TRUE, FALSE)
St_election$won = ifelse(St_election$totvotpoll == St_election$win_vote,TRUE, FALSE)

summary(Nat_election)
summary(St_election)

```

### Cleaning the data

Above we can see that in national election data we can see that the minimum winning vote is 0. which cant be true. We have the same problem for state election data.These may not be the wrong values, because manier times candidate was cancelled after information of booth capturing, manier times result Whithheal By High Court etc. These observation are very few(51 in state and 5 in national election) ,but this can effect out analysis so we have to remove these from our data set as a outliers.

```{r echo=FALSE, remove_outliars}
#filtering the outliars
Nat_election <- subset(Nat_election, win_vote != 0)
sprintf('Nation election data has %s Observation after filtering out Outliars.',NROW(Nat_election))
St_election <- subset(St_election, win_vote != 0)
sprintf('State election data has %s Observation after filtering out Outliars.',NROW(St_election))

```

```{r echo=FALSE, updated_summary}
#updated summary
summary(Nat_election$win_vote)
summary(St_election$win_vote)

```
# Univariate Plots Section

Now We are going to analyse out data in one dimention.

## 1. No of contestant contesting every election year
```{r echo=FALSE,message=FALSE, warning=FALSE, Univariate_Plots}

#converting year variable into type factor
Nat_election$year <- as.factor(Nat_election$year)
St_election$year <- as.factor(St_election$year)

#plotting the no of candidates contested each year in election
ggplot(Nat_election, aes(x=year)) + 
  geom_histogram(stat = 'count',fill = '#C51162',color="black") +
  theme(axis.text.x=element_text(angle=90, size=9)) +
  coord_flip() + theme_minimal() + scale_y_continuous(breaks=seq(0, 15000, 1000))+
  ggtitle("No of Contestant each year (National)")

ggplot(St_election, aes(x=year)) + 
  geom_histogram(stat = 'count',fill = '#2196F3',color="black") +
  theme(axis.text.x=element_text(angle=90, size=9)) +
  coord_flip() + theme_minimal() +
  ggtitle("No of Contestant each year (State)")

```

Here we can see that in the first graph(National), there is a consistent increase in number of contestant participating in the elction and goes up to 14000 in 1996.But after that it comes to less than 5000 in 1998 and it decreased even further in 1999.

The increase in 1996 could be because so many independent cadidate contested as it was the first election after india became an open economy which give indian citzen too many opportunities and contesting election was one of that.

In the second graph(State), there is not much we can say as each year few particular states went to polls. Though we can say that 1985 is the year when almost 25000(highest) contested in the elction.

## 2.Number of contestant based on gender.  

```{r echo=FALSE,message=FALSE, warning=FALSE, Univariate_Plots_sex}


#plotting the no of candidates contested each year in election
ggplot(subset(Nat_election,cand_sex != 'NULL'), aes(x=cand_sex)) + 
  geom_bar(stat = 'count',fill = '#C51162',color="black") +
  geom_text(stat="count", color="black", vjust = -0.1, size=3, aes(y=..count.., label=..count..)) + 
  theme(axis.text.x=element_text(angle=90, size=9)) +
   theme_minimal() +
  ggtitle("Contestant by Gender (National)")

ggplot(subset(St_election,cand_sex != ''), aes(x=cand_sex)) + 
  geom_bar(stat = 'count',fill = '#2196F3',color="black") +
  geom_text(stat="count", color="black", vjust = -0.1, size=3, aes(y=..count.., label=..count..)) + 
  theme(axis.text.x=element_text(angle=90, size=9)) +
   theme_minimal() +
  ggtitle("Contestant by Gender (State)")

```

In both the graphs we can see how Men can easily out numbered the womens in politics.womens had contested almost less than 5 percent as compared to mens. The other sex(or LGBT) has a long way to go in the indian politics as far as the numbers are concern.
It will be more intrsting to investigate how many women out of the few who contested did well in the elections. 

## 3.Number of contestant based on State.
```{r echo=FALSE,message=FALSE, warning=FALSE, Univariate_Plots_state}
#plots the histogram to see the no of contestant from each state

ggplot(Nat_election, aes(x=st_name)) + 
  geom_histogram(stat = 'count',fill = '#C51162',color="black") +
  theme(axis.text.x=element_text(angle=90, size=9)) +
  coord_flip() + theme_minimal() +
  ggtitle("No of Contestant from each state (National)") + xlab("States")

ggplot(St_election, aes(x=st_name)) + 
  geom_histogram(stat = 'count',fill = '#2196F3',color="black") +
  theme(axis.text.x=element_text(angle=90, size=9)) +
  coord_flip() + theme_minimal() + scale_y_continuous(breaks=seq(0, 65000, 10000)) +
  ggtitle("No of Contestant from each state (State election)") + xlab("States")

```

The above chart has no surprices as the states with highest population**(Uttar pradesh)** has highest number of candidates. But the second highest in population is **Maharashtra** but it stands at third position in number of candidates after **Bihar**. Also **West bengal** having fourth populated state stands at 9th position in number of candidates.

The data may look surprising but not too much for an Indian who is aware of political system of the conuntry.

**Bihar** and **Uttar pradesh** have been for a long time a hub for political revolution. which gives a mojority of polititians to the country.

**West Bengal** had been in a communist based government for almost 40 years out of 70 years of india's history which always believed to have a not so loving attitude toward democracy. this could explain how **West Bengal** ended up having less candidate despite have large population. 

## 4.Distribution of Proportion get by candidates

First lets see the summary of total vote polled.

#### National Election

```{r echo=FALSE,message=FALSE, warning=FALSE, totalvotepoll}

summary(Nat_election$totvotpoll)
summary(St_election$totvotpoll)

```

#### State Election

```{r echo=FALSE,message=FALSE, warning=FALSE, totalvotepoll_state}

summary(St_election$totvotpoll)

```

Now lets see the summary of vote proportion.

#### National Election

```{r echo=FALSE,message=FALSE, warning=FALSE, proportion}

summary(Nat_election$proportion)

```

#### State Election

```{r echo=FALSE,message=FALSE, warning=FALSE, proportion_state}

summary(St_election$proportion)

```

In the totvopoll we can see that the media is very small which gives us a rough idea that most of the candidate got a very few votes. This is also reflecting in the proportion summary the median proportion is 0.0066 percent which is insanely small as compared to the max value or the mean. More than 75 percent of the candidate didn't even get a 10 percent of vote share.

**Now lets plot this**

```{r echo=FALSE,message=FALSE, warning=FALSE, Univariate_Plots_vote}
# plot to see the distribution of votes polled
ggplot(Nat_election, aes(x=totvotpoll)) + 
     geom_bar(stat = 'count',fill = '#C51162',color="#C51162") +
     theme(axis.text.x=element_text(angle=90, size=9)) + theme_minimal() + 
     ggtitle("Distribution for votes polled (National)") + xlab("Votes polled")

ggplot(St_election, aes(x=totvotpoll)) + 
     geom_bar(stat = 'count',fill = '#2196F3',color = '#2196F3') +
     theme(axis.text.x=element_text(angle=90, size=9)) + theme_minimal() + 
     ggtitle("Distribution for votes polled (State)") + xlab("Votes polled")

```

The data is highly skewed as most of the candidates lost due to few no of votes. 
It will be good to see the data in log10 transformation.

```{r echo=FALSE,message=FALSE, warning=FALSE, Univariate_Plots_vote_log}
# plot to see the distribution of votes polled
ggplot(Nat_election, aes(x=totvotpoll)) + 
     geom_bar(stat = 'count',fill = '#C51162',color="#C51162") +
     theme(axis.text.x=element_text(angle=90, size=9)) + scale_x_log10() + theme_minimal() + 
     ggtitle("Distribution for votes polled (National)") + xlab("Votes polled(log10)")

ggplot(St_election, aes(x=totvotpoll)) + 
     geom_bar(stat = 'count',fill = '#2196F3',color = '#2196F3') +
     theme(axis.text.x=element_text(angle=90, size=9)) + scale_x_log10() + 
    theme_minimal() +  ggtitle("Distribution for votes polled (State)") + xlab("Votes Proportion(log10)")

```

log10 transformation gives a better picture of data. We almost got a normal distribution.

## 5. Which state loves women more
```{r echo=FALSE,warning=FALSE, univariate_Plots_5}

#filtering out the winning candidates
state_women_won = subset(Nat_election,won == TRUE & cand_sex == 'F') 

#plotting winning candidates by states
ggplot(state_women_won, aes(x=st_name)) + 
  geom_bar(stat = 'count',fill = '#C51162',color="white") +
  geom_text(stat="count", color="black", vjust = 0.4,hjust=-0.2, size=3, aes(y=..count.., label=..count..)) + coord_flip()+
  theme(axis.text.x=element_text(angle=90, size=9)) +
   theme_minimal() +
  ggtitle("States") + ylab('contestant count')

```

**Uttar pradesh** is at the top where maximum womens have won in the election, followed by **westbengal** and **Bihar**. There are Many states in which women politicians rarely won like **tripur**, **sikkim**, **jharkhand** etc.

## 6. Cast Divison In Parliament

India is a cast Based society, It thousands of casts which play an important role in election, there are some reserved seats in the parliament on which candidates from a particular cast can contest. Lets see how many cast reserve seats have been in the parliament through out the years of election.

There are two main cast who has reservation 

**1)** Schedule cast(SC)
**2)** Schedule cast(ST)

Every body else contest in **genral** category.

```{r echo=FALSE,warning=FALSE, univariate_Plots_6}

#filtering out the winning candidates and excluding candidate with no cast type
won_candidates = subset(Nat_election,won == TRUE & pc_type != '') 

#little bit more cleaning
won_candidates$pc_type[won_candidates$pc_type == 'SC '] <- 'SC'

#summary of the winning candidates by cast type
summary(won_candidates$pc_type)

#plotting cast vs count through out the yars
ggplot(won_candidates, aes(x=pc_type)) + 
  geom_bar(stat = 'count',fill = '#F44336',color="white") +
  geom_text(stat="count", color="white", vjust = 0.4,hjust=1.1, size=3, aes(y=..count.., label=..count..)) + coord_flip()+
  theme(axis.text.x=element_text(angle=90, size=9)) +
   theme_minimal() + facet_wrap(~year) +
  ggtitle("Reserve Seats for different casts") + ylab('contestant count') +xlab("Casts")

```

We can see from above that the seats reserves for candidates from particular cast are barely increased. for **SC** it is from **78** in **1977** to **84** in **2014** and for **ST** it went from **38** in **1977** to **47** in **2014**.

This may reflect that cast dominance is incresed in India through out these years.  

# Univariate Analysis

> **Tip**: Now that you've completed your univariate explorations, it's time to
reflect on and summarize what you've found. Use the questions below to help you
gather your observations and add your own if you have other thoughts!

### What is the structure of your dataset?

### What is/are the main feature(s) of interest in your dataset?

### What other features in the dataset do you think will help support your \
investigation into your feature(s) of interest?

### Did you create any new variables from existing variables in the dataset?

### Of the features you investigated, were there any unusual distributions? \
Did you perform any operations on the data to tidy, adjust, or change the form \
of the data? If so, why did you do this?


# Bivariate Plots and analysis

Now we are going to dig a little deeper in our analysis by adding one more dimension based on what we saw intresting in above plots. 

## 1. Proportion based on gender

```{r echo=FALSE, Bivariate_Plots}

#removing the observation with null values
Nat_election_gender <- subset(Nat_election,cand_sex != 'NULL')
St_election_gender <- subset(St_election,cand_sex != '')

#summary total votes by gender
by(Nat_election_gender$proportion, Nat_election_gender$cand_sex, summary)
by(St_election_gender$proportion, St_election_gender$cand_sex, summary)

#plotting the proportion vs gender plot
ggplot(Nat_election_gender, aes(x=cand_sex, y=proportion, fill = cand_sex)) + geom_boxplot() +
  scale_y_continuous(limits = c(0,0.01),breaks=seq(0, 0.01, .002)) +
  ggtitle('Proportion Boxplot By gender(National)')

ggplot(St_election_gender, aes(x=cand_sex, y=proportion, fill = cand_sex)) + geom_boxplot() +
  scale_y_continuous(limits = c(0,0.01),breaks=seq(0, 0.01, .002)) +
  ggtitle('Proportion Boxplot By gender(State)')

```

From the above Boxplot and summary we can say that most women in percentage has little bit better proportion of votes than men. Though women candidates are few, We have to see the female contribution as compared to men a little bit closer.

## 2.Women candidate By state
```{r echo=FALSE,warning=FALSE, Bivariate_Plots_1}

#Density plot winning and loosing candidate based on gender
ggplot(subset(Nat_election,cand_sex != 'O' & cand_sex != '' & cand_sex != 'NULL'), aes(x=proportion, fill=won)) +
  geom_density(binwidth=10, alpha=0.5) + scale_y_continuous(limits = c(0,10)) + facet_wrap(~cand_sex) +
  ggtitle('Win/loose vs vote proportion Density chart (National)')

ggplot(subset(St_election,cand_sex != 'O' & cand_sex != '' & cand_sex != 'NULL'), aes(x=proportion, fill=won)) +
  geom_density(binwidth=10, alpha=0.5) + scale_y_continuous(limits = c(0,10)) + facet_wrap(~cand_sex) +
  ggtitle('Win/loose vs vote proportion Density chart (State)')


```

We can see that both men and women who won the election share same distribution of proportion.

## 3. Women candidate By party

Lets see which party fielded more women candidate through out the years and how being in a  party effect the winning of a women candidate.
```{r echo=FALSE,warning=FALSE, Bivariate_Plots_2}

#Grouping the Females candidates By party and their status
Nat_election_party_women <- Nat_election %>%
          filter(cand_sex == 'F') %>%
          group_by(partyname,won) %>%
          summarise(count_no = n())

#sortion the data by no. of candidates by each party
Nat_election_party_women_sorted = Nat_election_party_women[order(-Nat_election_party_women$count_no),]

#Plotting Female contestant vs Political Party
P1 <- ggplot(head(subset(Nat_election_party_women_sorted,won == FALSE),10), aes(x=reorder(partyname,count_no),y=count_no)) + 
  geom_histogram(stat = 'identity',fill = '#C51162') +
  geom_text(stat="identity", color="white", vjust = 0.35, hjust=1.5, size=3, aes(y=count_no, label=count_no)) +
  theme(axis.text.x=element_text(angle=90, size=9)) +
  coord_flip() + theme_minimal() +
  ggtitle("No. of Female Cadidates by political parties who looses") + 
  xlab("Political Parties") + ylab("Female candidates count")

P2 <- ggplot(head(subset(Nat_election_party_women_sorted,won == TRUE),10), aes(x=reorder(partyname,count_no),y=count_no)) + 
  geom_histogram(stat = 'identity',fill = '#C51162') +
  geom_text(stat="identity", color="white", vjust = 0.35, hjust=1.5, size=3, aes(y=count_no, label=count_no)) +
  theme(axis.text.x=element_text(angle=90, size=9)) +
  coord_flip() + theme_minimal() + scale_y_continuous(limits = c(0,200))+
  ggtitle("No. of Female Cadidates by political parties who Won") + 
  xlab("Political Parties") + ylab("Female candidates count")

grid.arrange(P1, P2)

```

Here we can see that among top 10, the most of the womens contested as **Independent** and lost, It is very Hard for a women to contest and win an election as independent. But on the other hand if contesting women is in a political party, her chances to win is better.

**Indian National Congress** is at the top most political party whoose winning women candiate is higher than any other party followed by **Bhartiya Janta Party**.

## 3. Male candidate By party

Lets see which party fielded more women candidate through out the years and how being in a  party effect the winning of a women candidate.
```{r echo=FALSE,warning=FALSE, Bivariate_Plots_3}

#Grouping the Male candidates By party and their status
Nat_election_party_men <- Nat_election %>%
          filter(cand_sex == 'M') %>%
          group_by(partyname,won) %>%
          summarise(count_no = n())

#sortion the data by no. of candidates by each party
Nat_election_party_men_sorted = Nat_election_party_men[order(-Nat_election_party_men$count_no),]

#PLotting Male Contestant vs State
P1 <- ggplot(head(subset(Nat_election_party_men_sorted,won == FALSE),10), aes(x=reorder(partyname,count_no),y=count_no)) + 
  geom_histogram(stat = 'identity',fill = '#C51162') +
  geom_text(stat="identity", color="black", vjust = 0.35, hjust=0, size=3, aes(y=count_no, label=count_no)) +
  theme(axis.text.x=element_text(angle=90, size=9)) +
  coord_flip() + theme_minimal() +
  ggtitle("No. of Male Cadidates by political parties who looses") + 
  xlab("Political Parties") + ylab("Male candidates count")

P2 <- ggplot(head(subset(Nat_election_party_men_sorted,won == TRUE),10), aes(x=reorder(partyname,count_no),y=count_no)) + 
  geom_histogram(stat = 'identity',fill = '#C51162') + 
  geom_text(stat="identity", color="black", vjust = 0.35, hjust=0, size=3, aes(y=count_no, label=count_no)) +
  theme(axis.text.x=element_text(angle=90, size=9)) + scale_y_continuous(limits = c(0,1600)) +
  coord_flip() + theme_minimal() +
  ggtitle("No. of Male Cadidates by political parties who Won") + 
  xlab("Political Parties") + ylab("Male candidates count")

grid.arrange(P1, P2)

```

From the above data we can say that not just female, Infact male candidates are also vulnerable to faliure if they contested election as Independent. And the cances of winning is more if candiates belongs to a palititcal party.

## 4. Votes polled By state

```{r echo=FALSE,warning=FALSE, Bivariate_Plots_4_op}

#Grouping the States candidates By mean Vote proportion
Nat_election_states_vote <- Nat_election %>%
          group_by(st_name) %>%
          summarise(NAME_1=unique(st_name),
                    votes_poll = sum(totvotpoll),
                    total_vote = sum(unique(electors)))

Nat_election_states_vote$proportion = 1-
    Nat_election_states_vote$votes_poll/Nat_election_states_vote$total_vote

Nat_election_states_vote$state_prop = 1- (Nat_election_states_vote$total_vote)/sum(as.numeric(Nat_election_states_vote$total_vote))
#Loading Geo Data for Map
map_data <- readRDS("IND_adm1.rds")

#merging Map data with the grouped data 
merge_data <- merge(map_data,Nat_election_states_vote,by='NAME_1',x.all = TRUE)

#changing States type from chr to Factor
merge_data$NAME_1 = as.factor(merge_data$NAME_1)
merge_data$proportion[is.na(merge_data$proportion)] <- 0
merge_data$state_prop[is.na(merge_data$state_prop)] <- 0

spplot(merge_data,"NAME_1", col.regions=rgb(0.5,merge_data$state_prop,0.5), colorkey=T, main="Indian States")
#sortion the data by no. of candidates by each party


```

## 4.Rise And Fall Of Women.

Here we are going to see how many female cadidate make it to the parliament in the election.


```{r echo=FALSE,warning=FALSE, Bivariate_Plots_4}

#filtering out the winning women candidates
Women_won <- subset(Nat_election, cand_sex == 'F' & won == TRUE)

ggplot(Women_won, aes(x=year)) + 
  geom_bar(stat = 'count',fill = '#C51162',color="black") +
  geom_text(stat="count", color="black", vjust = -0.1, size=3, aes(y=..count.., label=..count..)) + 
  theme(axis.text.x=element_text(angle=90, size=9)) +
   theme_minimal() +
  xlab('Election Years') + ylab('candidates count') +
  ggtitle("winning Women candidates by year")

```

As happy to see a slow but yet progressive trend for women taking more seats in parliament through out the years.

## 5.Rise and fall of women's charisma

Here we are going to see how women candiate's vote proportion varies through out the years.

```{r echo=FALSE,warning=FALSE, Bivariate_Plots_5}

ggplot(Women_won, aes(x=proportion,color=year)) + geom_density(position="dodge")
```

2014 may be the year when maximum no of womens won the election but their vote share decreases than the previous elections. 

## 6. Respond to Independent's Call

Here we see the the performance of independent candidate through out years.

```{r echo=FALSE,warning=FALSE, Bivariate_Plots_ind}

#getting the independent candidates
independent_cand <- subset(Nat_election,(partyname == 'Independent' | partyname == 'Independents') & won == TRUE)


ggplot(independent_cand, aes(x=year)) + 
  geom_bar(stat = 'count',fill = '#C51162',color="black") +
  geom_text(stat="count", color="black", vjust = -0.1, size=3, aes(y=..count.., label=..count..)) + 
  theme(axis.text.x=element_text(angle=90, size=9)) +
   theme_minimal() +
  xlab('Election Years') + ylab('candidates count') +
  ggtitle("winning Independent candidates by year")

```

According to the above graph 2014 is the worst year for independent candidates where not single won the election. It is followed by the 1991 election where only 1 candidate won.

To conclude this we can say that Elections in india is a tough job for an Independent candidate rather than a candidate with a political party in his/her back.

## 7. States concious of democracy

Here we see the votepolled out of total electorats in each state.

```{r echo=FALSE,warning=FALSE, Bivariate_Plots_6}

#summing the  votes and electors by grouping them by state
state_grouped <- Nat_election %>%
  group_by(st_name) %>% 
  summarise(polled_vote = sum(totvotpoll),
            total_vote = sum(unique(electors)))

#making a proportion variable
state_grouped$proportion <- state_grouped$polled_vote/state_grouped$total_vote

ggplot(state_grouped, aes(x=reorder(st_name,proportion),y=proportion)) + 
  geom_histogram(stat = 'identity',fill = '#C51162') + 
  scale_y_continuous(labels = percent) + 
  geom_text(stat="identity", color="black", vjust = 0.35, hjust=0, size=3,aes(y=proportion, label=paste(round(proportion, 3)*100, "%", sep=""))) +
  theme(axis.text.x=element_text(angle=90, size=9)) +
  coord_flip() + theme_minimal() +
  ggtitle("People who voted in each state") + 
  xlab("States") + ylab("Percentage count of polled votes")

```


Above Bar Graph shows that Lakshdweep an island which is not a state but a union territory has the people which are more concious about election than any other state.

One intresting things in the above chart is that states like **West bengal**, **Nagaland**, **Tripura** which are suffering from gross insurgent military groups in their region has the high vote percentage than other states.

**Kerela** which is the most literate state in the country is also in the top 10.

## 8. Proportion vs Electors

we are going how much a candidate gathere vote based on the electors size in his constiuency.

```{r echo=FALSE,warning=FALSE, Bivariate_Plots_7}

#Filtering out the winning candidates
won_candidate_data <- subset(Nat_election,won == TRUE)

ggplot(won_candidate_data, aes(x=proportion,y=electors)) + geom_jitter(alpha=1/10) +
  scale_x_continuous(labels=percent,limits = c(0,0.8),breaks = seq(0,0.8,0.1)) +
  scale_y_continuous(labels = comma) + xlab("votes percentage") + ylab("total electors") + ggtitle("electors vs Vote proportion of winning candidates")

```

In above scatter plot we can see that most of the candidates won at a prcentage range of 15 to 45 there are very few winning candidate with less than 10% of vote share, also there are very few candidates with vote share grater than 50%. 

One Intresting point we can make here is that there is hardly any candidate having a total electors of more than 200,000 and having a vote share of more than 25% or 30%.

Lets look it in different years.


```{r echo=FALSE,warning=FALSE, Bivariate_Plots_8}

ggplot(won_candidate_data, aes(x=proportion,y=electors)) + geom_jitter(alpha=1/10) +
  scale_x_continuous(labels=percent,limits = c(0,0.8),breaks = seq(0,0.8,0.2)) +
  scale_y_continuous(labels = comma) + xlab("votes percentage") + ylab("total electors") + ggtitle("electors vs Vote proportion of winning candidates") + facet_wrap(~year)

```

```{r echo=FALSE,warning=FALSE, Bivariate_Plots_9}

P1 <- ggplot(subset(won_candidate_data,year == '1977'), aes(x=proportion,y=electors)) + geom_jitter(alpha=1/10) +
  scale_x_continuous(labels=percent,limits = c(0,0.8),breaks = seq(0,0.8,0.2)) +
  scale_y_continuous(labels = comma) + xlab("votes percentage") + ylab("total electors")

P2 <- ggplot(subset(won_candidate_data,year == '2014'), aes(x=proportion,y=electors)) + geom_jitter(alpha=1/10) +
  scale_x_continuous(labels=percent,limits = c(0,0.8),breaks = seq(0,0.8,0.2)) +
  scale_y_continuous(labels = comma) + xlab("votes percentage")

grid.arrange(P1,P2,ncol=2,top ="electors vs Vote share(%) winning candidates")

```
 
 In the First scatterplot(facet by years) we can see a pattern, more are more candidates in every metioned year got a similar vote share but at a much higher total electors.
 
 The very shift in the total electors we can see in the second graph which is of the first election(1977) and the last(2014). Also the variance in 1977 election is greater than in 2014.
 
 There could be two reasons for this:
 
 **1.** Due to population growth.
 **2.** Due to a consistent use of politics of populism.
 
 We will investigate furthur on our second point.

> **Tip**: As before, summarize what you found in your bivariate explorations
here. Use the questions below to guide your discussion.

### Talk about some of the relationships you observed in this part of the \
investigation. How did the feature(s) of interest vary with other features in \
the dataset?

### Did you observe any interesting relationships between the other features \
(not the main feature(s) of interest)?

### What was the strongest relationship you found?


# Multivariate Plots Section

> **Tip**: Now it's time to put everything together. Based on what you found in
the bivariate plots section, create a few multivariate plots to investigate
more complex interactions between variables. Make sure that the plots that you
create here are justified by the plots you explored in the previous section. If
you plan on creating any mathematical models, this is the section where you
will do that.

```{r echo=FALSE, Multivariate_Plots}

```

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. Were there features that strengthened each other in terms of \
looking at your feature(s) of interest?

### Were there any interesting or surprising interactions between features?

### OPTIONAL: Did you create any models with your dataset? Discuss the \
strengths and limitations of your model.

------

# Final Plots and Summary

> **Tip**: You've done a lot of exploration and have built up an understanding
of the structure of and relationships between the variables in your dataset.
Here, you will select three plots from all of your previous exploration to
present here as a summary of some of your most interesting findings. Make sure
that you have refined your selected plots for good titling, axis labels (with
units), and good aesthetic choices (e.g. color, transparency). After each plot,
make sure you justify why you chose each plot by describing what it shows.

### Plot One
```{r echo=FALSE, Plot_One}

```

### Description One


### Plot Two
```{r echo=FALSE, Plot_Two}

```

### Description Two


### Plot Three
```{r echo=FALSE, Plot_Three}

```

### Description Three

------

# Reflection

> **Tip**: Here's the final step! Reflect on the exploration you performed and
the insights you found. What were some of the struggles that you went through?
What went well? What was surprising? Make sure you include an insight into
future work that could be done with the dataset.

> **Tip**: Don't forget to remove this, and the other **Tip** sections before
saving your final work and knitting the final report!